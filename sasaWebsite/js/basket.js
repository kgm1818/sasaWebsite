$(function(){function e(){0==(t=void 0==$.cookie("myCart")?[]:JSON.parse($.cookie("myCart"))).length?($(".cart-empty").show().siblings("#main_shop").hide(),console.log(111)):$(".cart-empty").hide().siblings("#main_shop").show(),$("#cart_list .cart_detail").remove();for(var e=0,i=0,c=0;c<t.length;c++){var a=$("<li class=cart_detail></li>").appendTo($("#cart_list"));if(t[c].checked)s="<input type=checkbox class=ckbed checked=checked />";else var s="<input type=checkbox class=ckbed />";str2="<div class=J-pic>"+s+"<a href=javascript:; ><img src="+t[c].img+"></a></div><div class=J-state><p class=ui-carttable-title><a href=#>"+t[c].title+"</a></p><p class=ui-carttable-spec>"+t[c].quality+"</p></div><div class=J-price>"+t[c].price+"</div><div class=J-quantity><span class=btn-decrease>-</span><input type=text class=shop_num value="+t[c].num+" /><span class=btn-increase>+</span></div><div class=J-subtotal>￥"+t[c].price.replace("￥","")*t[c].num+".0</div><div class=J-btnDelete><a href=javascript:;>删除</a></div>",a.append(str2),t[c].checked&&(e++,i+=t[c].price.replace("￥","")*t[c].num)}e==t.length&&0!=t.length?$(".title_allChecked input").prop("checked",!0):$(".title_allChecked input").prop("checked",!1),numCart(),function(){for(var e=$.cookie("myCart"),t=void 0==e?[]:JSON.parse(e),i=0,c=0;c<t.length;c++)t[c].checked&&(i+=t[c].num);$(".items-quantity").html(i)}(),$(".promotion-subtotal").html("￥"+i+".0"),topCart()}var t=[];e(),$("#cart_list").on("click",".btn-decrease",function(){var i=$(this).index(".btn-decrease");t[i].num--,t[i].num<=1&&(t[i].num=1),$.cookie("myCart",JSON.stringify(t),{expires:30,path:"/"}),e()}),$("#cart_list").on("click",".btn-increase",function(i){i.stopPropagation(),i.preventDefault();var c=$(this).index(".btn-increase");t[c].num++,$.cookie("myCart",JSON.stringify(t),{expires:30,path:"/"}),e()}),$("#cart_list").on("click",".J-btnDelete",function(i){var c=$(this).index(".J-btnDelete");t.splice(c,1),$.cookie("myCart",JSON.stringify(t),{expires:30,path:"/"}),e()}),$("#cart_list").on("click",".ckbed",function(){var i=$(this).index(".ckbed");t[i].checked=$(this).prop("checked"),$.cookie("myCart",JSON.stringify(t),{expires:30,path:"/"}),e()}),$(".title_allChecked input").click(function(){if($(this).prop("checked"))for(i=0;i<t.length;i++)t[i].checked=!0;else for(var i=0;i<t.length;i++)t[i].checked=!1;$.cookie("myCart",JSON.stringify(t),{expires:30,path:"/"}),e()})});